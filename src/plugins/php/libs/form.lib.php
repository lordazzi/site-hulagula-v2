<?
################################################################################
################################################################################
###                                                                          ### 
###					ARQUIVO PHP DE FUNКНES PARA FORMUL┴RIOS					 ###
### 		(EDIК├O DE PLAVARAS, N┌MERO E VALIDAК├O DE FORMUL┴RIOS) v1.0 	 ###
###                                                                          ### 
################################################################################
################################################################################

##############################
#
#   funусo unacenta
#   Retira todos os acentos de uma palavra
#   $palavra = palavra a ter os acentos retirados
#
##############################

function unacenta($palavra) {
	str_replace("┬", "A", $palavra);
	str_replace("├", "A", $palavra);
	str_replace("┴", "A", $palavra);
	str_replace("└", "A", $palavra);
	str_replace("─", "A", $palavra);
	str_replace("Р", "a", $palavra);
	str_replace("с", "a", $palavra);
	str_replace("р", "a", $palavra);
	str_replace("Я", "a", $palavra);
	str_replace("С", "a", $palavra);
	str_replace("@", "a", $palavra);
	str_replace("╩", "E", $palavra);
	str_replace("╔", "E", $palavra);
	str_replace("╚", "E", $palavra);
	str_replace("╦", "E", $palavra);
	str_replace("Ж", "e", $palavra);
	str_replace("ж", "e", $palavra);
	str_replace("Я", "e", $palavra);
	str_replace("в", "e", $palavra);
	str_replace("╬", "I", $palavra);
	str_replace("═", "I", $palavra);
	str_replace("╠", "I", $palavra);
	str_replace("¤", "I", $palavra);
	str_replace("Ь", "i", $palavra);
	str_replace("ь", "i", $palavra);
	str_replace("В", "i", $palavra);
	str_replace("№", "i", $palavra);
	str_replace("н", "O", $palavra);
	str_replace("Н", "O", $palavra);
	str_replace("М", "O", $palavra);
	str_replace("м", "O", $palavra);
	str_replace("о", "O", $palavra);
	str_replace("З", "o", $palavra);
	str_replace("ш", "o", $palavra);
	str_replace("з", "o", $palavra);
	str_replace("Ы", "o", $palavra);
	str_replace("Ш", "o", $palavra);
	str_replace("█", "U", $palavra);
	str_replace("┌", "U", $palavra);
	str_replace("┘", "U", $palavra);
	str_replace("▄", "U", $palavra);
	str_replace("ч", "u", $palavra);
	str_replace("Щ", "u", $palavra);
	str_replace("щ", "u", $palavra);
	str_replace("Ч", "u", $palavra);
	str_replace("К", "C", $palavra);
	str_replace("у", "c", $palavra);
	str_replace("Л", "N", $palavra);
	str_replace("ы", "n", $palavra);
	return $palavra;
}

##############################
#
#   funусo domoney
#   Converte nЩmeros decimais ou inteiros para o formato 0.00 (duas casas depois da vьrgula)
#   $date = variavel a ser alterada
#
##############################

function domoney($valor) {
	$valor = str_replace("R", "", $valor);
	$valor = str_replace("U", "", $valor);
	$valor = str_replace("S", "", $valor);
	$valor = str_replace("$", "", $valor);
	$valor = str_replace(" ", "", $valor);
	$valor = str_replace(",", ".", $valor);
	if (onlynumbers($valor, ".")) {//sз pode ter nЩmeros e ponto se nсo retorna o mesmo valor
		$ponto = strpos($valor, ".");
		if ($ponto === 0 OR $ponto) { //se ponto existe ou ж exatamente igual a zero (por que nesse caso 0 nсo ж false, mas o primeiro valor da casa de uma string)
			$decimal = substr($valor, $ponto, 3);
			$valor = substr($valor, 0, $ponto);
			if ($ponto === 0) {
				$valor = "0".$valor;
			}
			
			if (strlen($decimal) == 2) {
				$decimal .= "0";
			}
			
			elseif (strlen($decimal) == 1) {
				$decimal .= "00";
			}
			
			return $valor.$decimal;
		}
		
		else {
			return $valor.".00";
		}
	}
	
	else {
		return $valor; //se o valor inserido tiver alguma coisa alжm de nЩmeros e o ponto, entсo a funусo retorna o prзprio valor em si.
	}
}

##############################
#
#   funусo ajeita
#   Essa funусo ajeita os nomes enviados para o banco de dados que forem escritos todos em maiusculas ou minusculas para o formato de primeira letra maiuscula e o resto minuscula, com exceусo de preposiушes
#
#   $nome = o nome a ser ajeitado
#
##############################

function ajeita($nome) {
	//deixa tudo em minuscula
	$nome = lower_acento($nome);
	$nome = strtolower($nome);
	
	//divide os nomes em arrays
	$nome = explode(" ", $nome);
	
	//deixando a primeira letra maiuscula das palavras que tenham mais de 3 letras
	$RunFor = count($nome); //nЩmero de vezes que o for irр rodar
	$final_nome = "";
	for ($IntFor = 0; $IntFor < $RunFor; $IntFor++) {
		if ($nome[$IntFor] == "de" OR $nome[$IntFor] == "la" OR $nome[$IntFor] == "el" OR $nome[$IntFor] == "dos" OR $nome[$IntFor] == "da" OR $nome[$IntFor] == "das" OR $nome[$IntFor] == "do" OR $nome[$IntFor] == "com" OR $nome[$IntFor] == "e" OR $nome[$IntFor] == "na" OR $nome[$IntFor] == "no" OR $nome[$IntFor] == "nas" OR $nome[$IntFor] == "nos" OR $nome[$IntFor] == "Яs" OR $nome[$IntFor] == "a" OR $nome[$IntFor] == "e" OR $nome[$IntFor] == "o" OR $nome[$IntFor] == "ou" OR $nome[$IntFor] == "pra" OR $nome[$IntFor] == "para" OR $nome[$IntFor] == "pras" OR $nome[$IntFor] == "pra" OR $nome[$IntFor] == "y") {
		}
		
		else {
			$nome[$IntFor] = ucfirst($nome[$IntFor]);
			if ($nome[$IntFor] == "Sao") { //corrigindo a mania feia de nсo colocar o tio no 'Sсo' dos nomes das cidades
				$nome[$IntFor] = "Sсo";
			}
			
			elseif ($nome[$IntFor] == "Joao") { 
				$nome[$IntFor] = "Joсo";
			}
		}
	}
	$nome = implode(" ", $nome);
	return $nome;
}

##############################
#
#   funусo mail_valid
#   verifica se o email colocado ж valido, retorna em true ou false (Email vрlido: verdadeiro? Email vрlido: falso?)
#
#   $email = o email a ser analisado
#
##############################

function mail_valid($mail) {
	$valido = true;
	
	if (strpos($mail, "@") == -1) {// tem arroba?
		$valido = false;
	}
	
	if (strpos($mail, ".com") == -1) {//tem .com
		$valido = false;
	}
	
	if (!strtolower($mail)) { //somente letras
		$valido = false;
	}
	
	if (!onlyletters($mail, "0123456789_-@.")) { //somente letras e nЩmero
		$valido = false;
	}
	
	return $valido;
}

##############################
#
#   funусo onlynumbers
#   verifica se uma string tem somente nЩmeros, retorna em true ou false (apenas nЩmero: verdadeiro? apenas letras: falso?)
#
#   $string = variavel a ser analisada
#	$addvalues = valores adicionais a serem aceitos
#
##############################

function onlynumbers($string, $addvalues = "") {
  $valid = true;
  for ($IntFor = 0; $IntFor < strlen($string); $IntFor++)
  {
    $char = lower_acento($string[$IntFor]);
    $rightchar = false;

        if ($char == "0") { $rightchar = true; }	elseif ($char == "1") { $rightchar = true; }
    elseif ($char == "2") { $rightchar = true; }	elseif ($char == "3") { $rightchar = true; }
    elseif ($char == "4") { $rightchar = true; }	elseif ($char == "5") { $rightchar = true; }
    elseif ($char == "6") { $rightchar = true; }	elseif ($char == "7") { $rightchar = true; }
    elseif ($char == "8") { $rightchar = true; }	elseif ($char == "9") { $rightchar = true; }
	
	if (strlen($addvalues) != "") //se nсo tiver nada na variavel de valores adicionais
	{
	  for ($IntFor2 = 0; $IntFor2 < strlen($addvalues); $IntFor2++)
	  {
	    $lowed = strtolower($addvalues[$IntFor2]);
		$lowed = lower_acento($lowed);
	    if ($char == $lowed) { $rightchar = true; }
	  }
	}
	
	if ($rightchar == false) { $valid = false; } //se ele nсo achou nenhuma das caracteres acima, o barato ж invalido (caracteres especiais, letras etc.)
  }
 
  return $valid;
}

##############################
#
#   funусo onlyletters
#   verifica se uma string tem somente letras ou espaуo, retorna em true ou false (apenas letras: verdadeiro? apenas letras: falso?)
#
#   $string = variavel a ser analisada
#	$addvalues = valores adicionais a serem aceitos
#
##############################

function onlyletters($string, $addvalues = "") {
  $valid = true;
  for ($IntFor = 0; $IntFor < strlen($string); $IntFor++)
  {
    $char = lower_acento($string[$IntFor]);
    $rightchar = false;

        if ($char == "a") { $rightchar = true; }	elseif ($char == "b") { $rightchar = true; }
    elseif ($char == "c") { $rightchar = true; }	elseif ($char == "d") { $rightchar = true; }
    elseif ($char == "e") { $rightchar = true; }	elseif ($char == "f") { $rightchar = true; }
    elseif ($char == "g") { $rightchar = true; }	elseif ($char == "h") { $rightchar = true; }
    elseif ($char == "i") { $rightchar = true; }	elseif ($char == "j") { $rightchar = true; }
    elseif ($char == "k") { $rightchar = true; }	elseif ($char == "l") { $rightchar = true; }
    elseif ($char == "m") { $rightchar = true; }	elseif ($char == "n") { $rightchar = true; }
    elseif ($char == "o") { $rightchar = true; }	elseif ($char == "p") { $rightchar = true; }
    elseif ($char == "q") { $rightchar = true; }	elseif ($char == "r") { $rightchar = true; }
    elseif ($char == "s") { $rightchar = true; }	elseif ($char == "t") { $rightchar = true; }
    elseif ($char == "u") { $rightchar = true; }	elseif ($char == "v") { $rightchar = true; }
    elseif ($char == "w") { $rightchar = true; }	elseif ($char == "x") { $rightchar = true; }
    elseif ($char == "y") { $rightchar = true; }	elseif ($char == "z") { $rightchar = true; }
	elseif ($char == " ") { $rightchar = true; }
	
	if (strlen($addvalues) != "") //se nсo tiver nada na variavel de valores adicionais
	{
	  for ($IntFor2 = 0; $IntFor2 < strlen($addvalues); $IntFor2++)
	  {
		$lowed = lower_acento($addvalues[$IntFor2]);
	    if ($char == $lowed) { $rightchar = true; }
	  }
	}
	
	if ($rightchar == false) { $valid = false; } //se ele nсo achou nenhuma das caracteres acima, o email ж invalido (caracteres especiais, letras com acento etc.)
  }
 
  return $valid;
}

##############################
#
#   funусo lower_acento
#   deixa todas as letras do termo em minusculas, incluindo acentos.
#
#   $term = a palavra a ter os acentos tornados em minusculas
#
##############################

function lower_acento($term) {
	$palavra = strtr(strtolower($term),"└┴┬├─┼кК╚╔╩╦╠═╬¤лЛмМнНоОп┘▄┌я▀","ЯрРсСтТуУжЖвВьЬ№­ыЫзЗшШэЭщЧЩ■ ");
    return $palavra;
}

##############################
#
#   funусo upper_acento
#   deixa todas as letras do termo em maiusculas, incluindo acentos.
#
#   $term = a palavra a ter os acentos tornados em maiusculas
#
##############################

function upper_acento($term) {
	$palavra = strtr(strtoupper($term),"ЯрРсСтТуУжЖвВьЬ№­ыЫзЗшШэЭщЧЩ■ ","└┴┬├─┼кК╚╔╩╦╠═╬¤лЛмМнНоОп┘▄┌я▀");
	return $palavra;
}

##############################
#
#   funусo isundermask (Estр debaixo da mascara?)
#   Verifica se o campo estр dentro da mascara que foi proposta.
#
#   $string = palavra a ser avaliada
#	$mask = mascara que ela deveria ter, 9 = nЩmero, A ou a = letra, * = para qualquer coisa (se case sensitive estivar ativado, entсo A ж apenas para letras maiusculas e a para minusculas)
#	$case = se as palavras devem ser tratadas com CASE SENSITIVE
#
##############################

function isundermask($string, $mask, $case = 1) {
	if (strlen($string) == strlen($mask)) {
		$isvalid = true; // predefine como valido
		for ($IntFor = 0; $IntFor < strlen($string); $IntFor++) {
			if ($case == 1)	{//se case sensitive estiver ativado
				$mask = lower_acento($mask);
				$string = lower_acento($string);
			}
			
			if ($mask[$IntFor] == "9") { //Somente nЩmeros
				if (!onlynumbers($string[$IntFor])) { //Se nсo for um nЩmero
					$isvalid = false;
				}
			}
			
			elseif ($mask[$IntFor] == "a") { //Somente letras minusculas
				if ($string[$IntFor] != lower_acento($string[$IntFor]) OR !onlyletters($string[$IntFor], "ЯрРсСтуУжЖвВьЬ№ыЫзЗшШщЧЩ")) { //se a letra nсo for igual a ela mesma em minuscula ou se ela nсo for uma letra
					$isvalid = false;
				}
			}
			
			elseif ($mask[$IntFor] == "A") { //Somente letras maiusculas
				if ($string[$IntFor] != upper_acento($string[$IntFor]) OR !onlyletters($string[$IntFor], "└┴┬├─┼К╚╔╩╦╠═╬¤ЛмМнНо┘▄┌")) { //se a letra nсo for igual a ela mesma em maiuscula ou se ela nсo for uma letra
					$isvalid = false;
				}
			}
			
			elseif ($mask[$IntFor] == "*") { //Qualquer coisa
				
			}
			
			else { //Obrigatзriamente o item da mascara
				if ($mask[$IntFor] !== $string[$IntFor]) {
					$isvalid = false;
				}
			}
		}//final do for
		
		return $isvalid;
	}
	
	else {
		return false;
	}
}
?>